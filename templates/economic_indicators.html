{% extends "base.html" %}

{% block title %}ê²½ì œì§€í‘œ ëŒ€ì‹œë³´ë“œ - Stock Insight AI{% endblock %}
{% block meta_description %}ë¯¸êµ­ ì£¼ìš” ê²½ì œì§€í‘œ(Fed ê¸ˆë¦¬, CPI, êµ­ì±„, VIX, SOX ë“±) ìƒê´€ê´€ê³„ ë¶„ì„ ë° AI ì˜ˆì¸¡ ëª¨ë¸ ëŒ€ì‹œë³´ë“œ{% endblock %}
{% block og_title %}ê²½ì œì§€í‘œ ëŒ€ì‹œë³´ë“œ - Stock Insight AI{% endblock %}
{% block og_description %}Fed ê¸ˆë¦¬, CPI, 10ë…„ êµ­ì±„, VIX, SOX ë°˜ë„ì²´ì§€ìˆ˜ ë“± 11ê°œ ê²½ì œì§€í‘œ ìƒê´€ê´€ê³„ ë¶„ì„ ë° ë‹¤ìŒ ë‹¬ ì‹œì¥ ë°©í–¥ AI ì˜ˆì¸¡{% endblock %}
{% block canonical_path %}/economic-indicators{% endblock %}

{% block structured_data %}
<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "WebPage",
    "name": "ê²½ì œì§€í‘œ ëŒ€ì‹œë³´ë“œ - Stock Insight AI",
    "description": "ë¯¸êµ­ ì£¼ìš” ê²½ì œì§€í‘œ ìƒê´€ê´€ê³„ ë¶„ì„ ë° AI ê¸°ë°˜ ì‹œì¥ ë°©í–¥ ì˜ˆì¸¡",
    "url": "https://stock-insight.app/economic-indicators",
    "isPartOf": {
        "@type": "WebSite",
        "name": "Stock Insight AI",
        "url": "https://stock-insight.app"
    }
}
</script>
{% endblock %}

{% block content %}
<!-- í—¤ë” -->
<div class="glass-panel" style="padding: 1.25rem; margin-bottom: 1.5rem;">
    <h3 style="margin: 0; font-size: 1.5rem; display: flex; align-items: center; gap: 0.5rem;">
        <span style="font-size: 2rem;">ğŸ“ˆ</span>
        <span class="gradient-text">ê²½ì œì§€í‘œ ëŒ€ì‹œë³´ë“œ</span>
    </h3>
    <p style="color: #94a3b8; margin-top: 0.5rem; margin-bottom: 0;">
        Fed ê¸ˆë¦¬, CPI, êµ­ì±„ ìˆ˜ìµë¥ , VIX, SOX ë°˜ë„ì²´ì§€ìˆ˜ ë“± 11ê°œ í•µì‹¬ ê²½ì œì§€í‘œì˜ ìƒê´€ê´€ê³„ë¥¼ ë¶„ì„í•˜ê³ ,
        RandomForest ëª¨ë¸ë¡œ ë‹¤ìŒ ë‹¬ ì‹œì¥ ë°©í–¥ì„ ì˜ˆì¸¡í•©ë‹ˆë‹¤.
        {% if data_start and data_end %}
        <span style="color: #64748b; font-size: 0.85rem; margin-left: 0.5rem;">
            ë°ì´í„° ê¸°ê°„: {{ data_start }} ~ {{ data_end }}
        </span>
        {% endif %}
    </p>
</div>

{% if error %}
<div class="glass-panel" style="border-color: #fca5a5; color: #fca5a5; padding: 1.5rem;">
    âš ï¸ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: {{ error }}
</div>
{% else %}

<!-- ì§€í‘œ ì¹´ë“œ ê·¸ë¦¬ë“œ -->
{% if indicators_display %}
<div class="glass-panel" style="padding: 1.25rem; margin-bottom: 1.5rem;">
    <h4 style="margin: 0 0 1rem 0; color: #e2e8f0; font-size: 1rem; font-weight: 600;">
        ğŸ“Š ì£¼ìš” ê²½ì œì§€í‘œ í˜„í™©
    </h4>
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 0.75rem;">
        {% for ind in indicators_display %}
        <div style="background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.06); border-radius: 12px; padding: 0.9rem 1rem;">
            <div style="display: flex; align-items: center; gap: 0.4rem; margin-bottom: 0.35rem;">
                <span style="font-size: 1.1rem;">{{ ind.icon }}</span>
                <span style="color: #94a3b8; font-size: 0.78rem; font-weight: 500;">{{ ind.label }}</span>
            </div>
            {% if ind.current is not none %}
            <div style="font-size: 1.25rem; font-weight: 700; color: #f1f5f9;">
                {% if ind.unit == '$' %}${% endif %}
                {{ "%.2f"|format(ind.current) }}
                {% if ind.unit and ind.unit != '$' %}<span style="font-size: 0.8rem; color: #64748b; margin-left: 2px;">{{ ind.unit }}</span>{% endif %}
            </div>
            {% if ind.change is not none %}
            <div style="font-size: 0.8rem; margin-top: 0.2rem; color: {% if ind.change >= 0 %}#4ade80{% else %}#f87171{% endif %};">
                {{ "%+.2f"|format(ind.change) }}
                {% if ind.change_pct is not none %}({{ "%+.1f"|format(ind.change_pct) }}%){% endif %}
            </div>
            {% endif %}
            {% else %}
            <div style="color: #475569; font-size: 0.9rem;">ë°ì´í„° ì—†ìŒ</div>
            {% endif %}
            <div style="color: #475569; font-size: 0.72rem; margin-top: 0.4rem; line-height: 1.3;">{{ ind.desc }}</div>
        </div>
        {% endfor %}
    </div>
</div>
{% endif %}

<!-- ML ì˜ˆì¸¡ ê²°ê³¼ -->
{% if index_predictions %}
<div class="glass-panel" style="padding: 1.25rem; margin-bottom: 1.5rem;">
    <h4 style="margin: 0 0 0.25rem 0; color: #e2e8f0; font-size: 1rem; font-weight: 600;">
        ğŸ¤– AI ì˜ˆì¸¡ ëª¨ë¸ â€” ë‹¤ìŒ ë‹¬ ì£¼ìš” ì§€ìˆ˜ ë°©í–¥
    </h4>
    <p style="color: #64748b; font-size: 0.8rem; margin: 0 0 1rem 0;">
        ê³¼ê±° ê²½ì œì§€í‘œ(Fed ê¸ˆë¦¬Â·CPIÂ·êµ­ì±„Â·í™˜ìœ¨Â·ì‚°ì—…ìƒì‚°Â·ìœ ê°€Â·VIX) ê¸°ë°˜ RandomForest 200 trees
    </p>

    <!-- ì§€ìˆ˜ë³„ ì˜ˆì¸¡ ì¹´ë“œ -->
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 1rem; margin-bottom: 1.25rem;">
        {% for pred in index_predictions %}
        <div style="text-align: center;
                    background: rgba({% if pred.direction == 'ìƒìŠ¹' %}74,222,128{% else %}248,113,113{% endif %},0.07);
                    border: 1px solid {{ pred.direction_color }}44;
                    border-radius: 14px; padding: 1.2rem 0.8rem;">
            <div style="font-size: 0.8rem; font-weight: 600; color: {{ pred.color }}; margin-bottom: 0.4rem; letter-spacing: 0.03em;">
                {{ pred.name }}
            </div>
            <div style="font-size: 2.2rem; margin-bottom: 0.3rem;">{{ pred.direction_icon }}</div>
            <div style="font-size: 1.5rem; font-weight: 800; color: {{ pred.direction_color }};">
                {{ pred.direction }}
            </div>
            <div style="color: #94a3b8; font-size: 0.78rem; margin-top: 0.45rem;">
                ì‹ ë¢°ë„ <strong style="color: #e2e8f0;">{{ pred.confidence }}%</strong>
            </div>
            <div style="color: #475569; font-size: 0.7rem; margin-top: 0.25rem;">
                ì •í™•ë„ {{ pred.accuracy }}% Â· {{ pred.data_months }}ê°œì›”
            </div>
        </div>
        {% endfor %}
    </div>

    <!-- Feature Importance ì°¨íŠ¸ -->
    {% if feature_importance_json %}
    <div>
        <div style="color: #64748b; font-size: 0.8rem; margin-bottom: 0.4rem;">
            ğŸ“Œ ì˜ˆì¸¡ì— ê°€ì¥ ì¤‘ìš”í•œ ì§€í‘œ (3ê°œ ì§€ìˆ˜ í‰ê·  Feature Importance)
        </div>
        <div id="fi-chart" style="width: 100%; height: 280px;"></div>
    </div>
    {% endif %}

    <div style="color: #475569; font-size: 0.75rem; margin-top: 1rem; padding-top: 0.75rem; border-top: 1px solid rgba(255,255,255,0.05);">
        âš ï¸ ì´ ì˜ˆì¸¡ì€ ê³¼ê±° ë°ì´í„° ê¸°ë°˜ í†µê³„ ëª¨ë¸ë¡œ, ì‹¤ì œ íˆ¬ì ê²°ì •ì— ì§ì ‘ í™œìš©í•˜ì§€ ë§ˆì„¸ìš”. ì°¸ê³ ìš©ìœ¼ë¡œë§Œ ì‚¬ìš©í•˜ì‹­ì‹œì˜¤.
    </div>
</div>
{% endif %}

<!-- ìƒê´€ê´€ê³„ íˆíŠ¸ë§µ -->
{% if heatmap_json %}
<div class="glass-panel" style="padding: 1.25rem; margin-bottom: 1.5rem;">
    <h4 style="margin: 0 0 0.3rem 0; color: #e2e8f0; font-size: 1rem; font-weight: 600;">
        ğŸ”¥ ê²½ì œì§€í‘œ Ã— ì£¼ê°€ì§€ìˆ˜ ìƒê´€ê´€ê³„ íˆíŠ¸ë§µ
    </h4>
    <p style="color: #64748b; font-size: 0.8rem; margin: 0 0 0.6rem 0;">
        1ì— ê°€ê¹Œìš¸ìˆ˜ë¡ ê°•í•œ ì–‘ì˜ ìƒê´€ (í•¨ê»˜ ì˜¤ë¦„), -1ì— ê°€ê¹Œìš¸ìˆ˜ë¡ ê°•í•œ ìŒì˜ ìƒê´€ (ë°˜ëŒ€ë¡œ ì›€ì§ì„).
        <span style="color: rgba(251,191,36,0.85);">â”„â”„</span> ì ì„  ì˜¤ë¥¸ìª½/ì•„ë˜ê°€ ì£¼ê°€ ì§€ìˆ˜(NASDAQÂ·S&P500Â·KOSPI) ì˜ì—­
    </p>
    <div id="heatmap-chart" style="width: 100%;"></div>

    <!-- ì£¼ê°€-ê²½ì œì§€í‘œ í•µì‹¬ ìƒê´€ê´€ê³„ Top 3 í…Œì´ë¸” -->
    {% if corr_top_rows %}
    <div style="margin-top: 1.25rem; border-top: 1px solid rgba(255,255,255,0.06); padding-top: 1rem;">
        <div style="font-size: 0.82rem; font-weight: 600; color: #e2e8f0; margin-bottom: 0.75rem;">
            ğŸ“Œ ì£¼ê°€ì§€ìˆ˜ë³„ ìƒê´€ê´€ê³„ ìƒìœ„ ì§€í‘œ Top 3
            <span style="font-size: 0.72rem; font-weight: 400; color: #475569; margin-left: 0.5rem;">
                â€” ì ˆëŒ“ê°’ì´ í´ìˆ˜ë¡ ì˜ˆì¸¡ ëª¨ë¸ì— ë” í° ì˜í–¥
            </span>
        </div>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 0.75rem;">
            {% set ns = namespace(last_stock='') %}
            {% for row in corr_top_rows %}
            {% if row.stock != ns.last_stock %}
            {% if ns.last_stock != '' %}</div>{% endif %}
            <div style="background: rgba(255,255,255,0.02); border: 1px solid rgba(255,255,255,0.06); border-radius: 10px; padding: 0.75rem;">
                <div style="font-size: 0.78rem; font-weight: 700; color: #38bdf8; margin-bottom: 0.5rem;">{{ row.stock }}</div>
            {% set ns.last_stock = row.stock %}
            {% endif %}
                <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.35rem;">
                    <span style="font-size: 0.72rem; color: #94a3b8; width: 120px; flex-shrink: 0;">{{ row.indicator }}</span>
                    <div style="flex: 1; background: rgba(255,255,255,0.05); border-radius: 4px; height: 6px; overflow: hidden;">
                        <div style="width: {{ row.bar_width }}%; background: {{ row.color }}; height: 100%; border-radius: 4px; opacity: 0.8;"></div>
                    </div>
                    <span style="font-size: 0.72rem; font-weight: 700; color: {{ row.color }}; width: 40px; text-align: right;">
                        {{ row.sign }}{{ "%.2f"|format(row.corr) }}
                    </span>
                </div>
            {% endfor %}
            </div>
        </div>
    </div>
    {% endif %}
</div>
{% endif %}

<!-- ì£¼ìš” ì§€í‘œ íŠ¸ë Œë“œ ì°¨íŠ¸ (ìµœê·¼ 5ë…„) -->
{% if trend_json %}
<div class="glass-panel" style="padding: 1.25rem; margin-bottom: 1.5rem;">
    <h4 style="margin: 0 0 0.5rem 0; color: #e2e8f0; font-size: 1rem; font-weight: 600;">
        ğŸ“‰ ì£¼ìš” ê¸ˆë¦¬/ìœ„í—˜ ì§€í‘œ ì¶”ì´ (ìµœê·¼ 5ë…„)
    </h4>
    <p style="color: #64748b; font-size: 0.8rem; margin: 0 0 0.75rem 0;">
        Fed ê¸°ì¤€ê¸ˆë¦¬, 10ë…„ êµ­ì±„ ìˆ˜ìµë¥ , VIX ê³µí¬ì§€ìˆ˜ ë¹„êµ
    </p>
    <div id="trend-chart" style="width: 100%; height: 300px;"></div>
</div>
{% endif %}

{% endif %}{# end if not error #}

<script>
{% if heatmap_json %}
(function() {
    var heatmapData = {{ heatmap_json | safe }};
    Plotly.newPlot('heatmap-chart', heatmapData.data, heatmapData.layout, {
        responsive: true, displayModeBar: false
    });
})();
{% endif %}

{% if trend_json %}
(function() {
    var trendData = {{ trend_json | safe }};
    Plotly.newPlot('trend-chart', trendData.data, trendData.layout, {
        responsive: true, displayModeBar: false
    });
})();
{% endif %}

{% if feature_importance_json %}
(function() {
    var fiData = {{ feature_importance_json | safe }};
    Plotly.newPlot('fi-chart', fiData.data, fiData.layout, {
        responsive: true, displayModeBar: false
    });
})();
{% endif %}
</script>
{% endblock %}
